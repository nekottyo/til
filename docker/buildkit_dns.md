BuildKit は `--dns` オプションを読まない
===

https://github.com/moby/buildkit/issues/734

普通の docker run は読む(buildkitじゃないので)

```
➜ docker run --privileged -e DOCKER_BUILDKIT=1 -d docker:dind --storage-driver=overlay --dns 8.8.8.8
3ae3e1436bf38648056dccff8c2f997a381f0719dfba22869d6249f28f0c8337
➜ d exec -it 3ae3e1436bf3 sh
/ # docker run --rm -ti alpine
/ # cat /etc/resolv.conf
nameserver 8.8.8.8 # --dns が使われる
```

```
/ # cat Dockerfile 
FROM debian
RUN cat /etc/resolv.conf && exit 1

/ # docker build .
[+] Building 40.9s (5/5) FINISHED
=> [internal] load .dockerignore 0.1s
=> => transferring context: 2B 0.0s
=> [internal] load build definition from Dockerfile 0.2s
=> => transferring dockerfile: 85B 0.0s
=> [internal] load metadata for docker.io/library/debian:latest 17.6s
=> [1/2] FROM docker.io/library/debian@sha256:724b0fbbda7fda6372ffed586670573c59e07a48c86d606bab05db118abe0ef5 13.9s
=> => resolve docker.io/library/debian@sha256:724b0fbbda7fda6372ffed586670573c59e07a48c86d606bab05db118abe0ef5 0.0s
=> => sha256:724b0fbbda7fda6372ffed586670573c59e07a48c86d606bab05db118abe0ef5 2.36kB / 2.36kB 0.0s
=> => sha256:9a1b6b1073bf12428a55c54e6e3bb001946afbcf49b7fea6a02d345790356998 529B / 529B 0.0s
=> => sha256:2d337f242f078dfa62c81db584e78e33fd6bf6138875ecfb11fa470f26a5411c 1.50kB / 1.50kB 0.0s
=> => sha256:e79bb959ec00faf01da52437df4fad4537ec669f60455a38ad583ec2b8f00498 45.34MB / 45.34MB 12.3s
=> => extracting sha256:e79bb959ec00faf01da52437df4fad4537ec669f60455a38ad583ec2b8f00498 1.0s
=> ERROR [2/2] RUN cat /etc/resolv.conf && exit 1 9.1s
------
> [2/2] RUN cat /etc/resolv.conf && exit 1:
#5 0.510 # Generated by resolvconf
#5 0.510 nameserver 192.168.1.1
#5 0.510
------
```

上記の `resolv.conf` は host -> dind -> build 上のコンテナでマウントされたもの

```
(ホストOS 側)
➜ cat /etc/resolv.conf
# Generated by resolvconf
nameserver 192.168.1.1
```
